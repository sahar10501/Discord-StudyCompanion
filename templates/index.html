{% extends 'layout.html' %}
{% block head %}

{% endblock %}

{% block main %}
<div class='container-fluid p-0 mt-3 mb-4'>
<div class='row'>
  {% if guild_users %} 
  <div id="guild_users_col" class='col-3'>
    <div class='vertical-menu'>
        <ul style='padding: 0; margin-left: 1rem;'>
        {% for user in guild_users %}
            <li class='nav-item' style='margin-bottom: 1rem;'>
              <div class='card' >
                  <div class='card-body h-25'>
                    <div class='row'>
                      <div class='col-9'><h5 class='card-title'>{{ user['username'] | safe }}</h5></div>
                      <div class='col-3'>
                        {% if user['avatar'] is not none %}
                        <img id="{{ loop.index }}" src="https://cdn.discordapp.com/avatars/{{ user['user_id'] | safe }}/{{ user['avatar'] | safe }}.webp?size=1024"
                        class='img-responsive rounded-circle' alt='User Image' width='40' height='40'>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                    <p class='card-text'></p>
                    <div class='card-footer text-muted' >
                      <div class='row'>
                        <div class='col-3'>
                          <button type='button' aria-pressed="true" data-bs-toggle="button"  class='user_buttons btn btn-primary active' style='background-color: #4e62f0;' 
                          value="{{ user['username'] }}" data-avatar_id="{{ user['avatar'] }}" data-user_id="{{ user['user_id'] }}">Invite</button>
                        </div>
                        <div class='col-3'><div style='margin-top: 5px; text-decoration: underline;'>Status</div></div>
                      </div>
                  </div>
                </div>
             </li>
            {% endfor %}
          </ul>
      </div>
  </div>
  {% endif %}

  <div class='col'>
    <div id='invite_list'></div>
 
    <div class='row mt-4'>
      <div class='col-lg-3'>
        <p style='color: white; font-size: 25px; text-decoration-line: underline;' 
          class='text-center'>Session Topic:
        </p>
        <p id='channel_name_html' style=' color: white; font-size: 1rem;' class='text-center'>{% if session_manager is defined %} {{session_manager.name}} {% endif %}</p>
      </div>
      <div class='col-lg-3'><p style='color: #f7f7f7; font-size: 25px;' class='text-center'>53#</p>
        <p style='text-decoration-line: overline; color: white;' class='text-center'>Session number</p>
      </div>
      <div class='col-lg-3'><p id="current_time" style='color: #f7f7f7; font-size: 25px;' class='text-center'></p>
        <p style='text-decoration-line: overline; color: white;' class='text-center'>Start time {% if user_info is defined %}aaaaa{{user_info }}{% endif %}</p>
      </div>
      <div class='col-lg-3'><p  style='color: #f7f7f7; font-size: 25px;' class='text-center'>{{ duration}}</p>
        <p style='text-decoration-line: overline; color: white;' class='text-center'>Session Duration</p>
      </div>
    </div>

    <div class='row mt-5 pt-5'>
      {% if session_manager is not defined %}
      <div class='col-lg-3'>
        <button type='button' class='d-grid btn btn-primary btn-lg col-6 mx-auto' 
        data-bs-toggle="modal" data-bs-target="#invite_modal" id="open_inv_modal">Invite</button>
      </div>
      <div class='col-lg-3'>
      </div>
      <div class='col-lg-3'>
      </div>
      {% endif %}
      <div class='col'>
        {% if session_manager is not defined %}
        <button type='button' id="open_start_modal" value="start" class='d-grid btn btn-primary btn-lg col-6 mx-auto' 
        data-bs-toggle="modal" data-bs-target="#start_modal">Start</button>
        {% else %}
        <button type='button' id='session_control' value="stop" class='d-grid btn btn-primary btn-lg col-6 mx-auto'>Stop</button>
        {% endif %}

      </div>
    </div>
    </div>
  </div>
  <!-- Modal - Prompts the users with the abillity to set a study session -->
  <div class="modal fade" id="invite_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="invite_modalLabel">Create Study Session</h5>
        </div>
        <div class="modal-body">
          <form>
            <div class="mb-3">
              <label for="channel_name" class="form-label">Study Session Name</label>
              <input type="text" autocomplete="off" class="form-control" id="channel_name" placeholder="Linux Fundamentals Session">
            </div>
            <div class="mb-3">
              <label for="description" class="form-label">Description</label>
              <textarea class="form-control" id="description" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id='close_inv_modal'>Close</button>
          <button type="button" id="invite_button" class="btn btn-primary" data-bs-dismiss="modal" >Invite</button>
        </div>
      </div>
    </div>
  </div>
  

  <!-- Modal - Prompts the users with the current connected users and an option to proceed to lock
      Study session  -->
  <div class="modal fade" id="start_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="start_modalLabel">Start the Session!</h5>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Status</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody id="inv_user_tbl">
              
            </tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id='close_inv_modal'>Close</button>
          <button type="button"  id="session_control" value="start" class="btn btn-primary" data-bs-dismiss="modal" >Start</button>
        </div>
      </div>
    </div>
  </div>



</div>
<script type="text/javascript" src="/static/home-script.js"></script>

{% endblock %}
